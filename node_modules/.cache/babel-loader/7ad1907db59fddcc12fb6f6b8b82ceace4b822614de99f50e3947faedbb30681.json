{"ast":null,"code":"import _regeneratorRuntime from\"/Users/bellaxia/Desktop/today-I-learned/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _toConsumableArray from\"/Users/bellaxia/Desktop/today-I-learned/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _asyncToGenerator from\"/Users/bellaxia/Desktop/today-I-learned/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/bellaxia/Desktop/today-I-learned/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useState}from\"react\";import supabase from\"./supabase\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var _require=require(\"./Data.js\"),CATEGORIES=_require.CATEGORIES;function isValidHttpUrl(string){var url;try{url=new URL(string);}catch(_){return false;}return url.protocol===\"http:\"||url.protocol===\"https:\";}function NewFactForm(_ref){var facts=_ref.facts,setFacts=_ref.setFacts,setShowForm=_ref.setShowForm;var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),text=_useState2[0],setText=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),source=_useState4[0],setSource=_useState4[1];var _useState5=useState(\"\"),_useState6=_slicedToArray(_useState5,2),category=_useState6[0],setCategory=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),isUploading=_useState8[0],setIsUploading=_useState8[1];var textLength=text.length;function handleSubmit(_x){return _handleSubmit.apply(this,arguments);}function _handleSubmit(){_handleSubmit=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(e){var _yield$supabase$from$,newFact,error;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:// 1. Prevent browser from reload\ne.preventDefault();// 2. Check if data is valid. If so create a new fact\nsetIsUploading(true);if(!(text&&isValidHttpUrl(source)&&category&&textLength<=200)){_context.next=14;break;}_context.next=5;return supabase.from(\"facts\").insert([{text:text,source:source,category:category}]).select();case 5:_yield$supabase$from$=_context.sent;newFact=_yield$supabase$from$.data;error=_yield$supabase$from$.error;// 4. Add the new fact to the UI\nsetIsUploading(false);if(!error)setFacts(function(facts){return[newFact[0]].concat(_toConsumableArray(facts));});// 5. Reset the input fields\nsetText(\"\");setSource(\"\");setCategory(\"\");// 6. Close the entire form\nsetShowForm(false);case 14:setIsUploading(false);case 15:case\"end\":return _context.stop();}},_callee);}));return _handleSubmit.apply(this,arguments);}return/*#__PURE__*/_jsxs(\"form\",{className:\"fact-form\",onSubmit:handleSubmit,children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Share a fact with the world...\",value:text,onChange:function onChange(e){return setText(e.target.value);},disabled:isUploading}),/*#__PURE__*/_jsx(\"span\",{children:200-textLength}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Trustworthy sourse...\",value:source,onChange:function onChange(e){return setSource(e.target.value);},disabled:isUploading}),/*#__PURE__*/_jsxs(\"select\",{value:category,onChange:function onChange(e){return setCategory(e.target.value);},disabled:isUploading,children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Choose category:\"}),CATEGORIES.map(function(cat){return/*#__PURE__*/_jsx(\"option\",{value:cat.name,children:cat.name},cat.name);}),\";\"]}),/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-large\",disabled:isUploading,children:\"Post\"})]});}export default NewFactForm;","map":{"version":3,"names":["useState","supabase","jsx","_jsx","jsxs","_jsxs","_require","require","CATEGORIES","isValidHttpUrl","string","url","URL","_","protocol","NewFactForm","_ref","facts","setFacts","setShowForm","_useState","_useState2","_slicedToArray","text","setText","_useState3","_useState4","source","setSource","_useState5","_useState6","category","setCategory","_useState7","_useState8","isUploading","setIsUploading","textLength","length","handleSubmit","_x","_handleSubmit","apply","arguments","_asyncToGenerator","_regeneratorRuntime","mark","_callee","e","_yield$supabase$from$","newFact","error","wrap","_callee$","_context","prev","next","preventDefault","from","insert","select","sent","data","concat","_toConsumableArray","stop","className","onSubmit","children","type","placeholder","value","onChange","target","disabled","map","cat","name"],"sources":["/Users/bellaxia/Desktop/today-I-learned/src/NewFactForm.js"],"sourcesContent":["import { useState } from \"react\";\nimport supabase from \"./supabase\";\nconst { CATEGORIES } = require(\"./Data.js\");\n\nfunction isValidHttpUrl(string) {\n  let url;\n  try {\n    url = new URL(string);\n  } catch (_) {\n    return false;\n  }\n  return url.protocol === \"http:\" || url.protocol === \"https:\";\n}\n\nfunction NewFactForm({ facts, setFacts, setShowForm }) {\n  const [text, setText] = useState(\"\");\n  const [source, setSource] = useState(\"\");\n  const [category, setCategory] = useState(\"\");\n  const [isUploading, setIsUploading] = useState(false);\n  const textLength = text.length;\n\n  async function handleSubmit(e) {\n    // 1. Prevent browser from reload\n    e.preventDefault();\n    // 2. Check if data is valid. If so create a new fact\n    setIsUploading(true);\n    if (text && isValidHttpUrl(source) && category && textLength <= 200) {\n      // 3. Upload to supabase\n      const { data: newFact, error } = await supabase\n        .from(\"facts\")\n        .insert([{ text, source, category }])\n        .select();\n\n      // 4. Add the new fact to the UI\n      setIsUploading(false);\n      if (!error) setFacts((facts) => [newFact[0], ...facts]);\n\n      // 5. Reset the input fields\n      setText(\"\");\n      setSource(\"\");\n      setCategory(\"\");\n\n      // 6. Close the entire form\n      setShowForm(false);\n    }\n    setIsUploading(false);\n  }\n\n  return (\n    <form className=\"fact-form\" onSubmit={handleSubmit}>\n      <input\n        type=\"text\"\n        placeholder=\"Share a fact with the world...\"\n        value={text}\n        onChange={(e) => setText(e.target.value)}\n        disabled={isUploading}\n      />\n      <span>{200 - textLength}</span>\n      <input\n        type=\"text\"\n        placeholder=\"Trustworthy sourse...\"\n        value={source}\n        onChange={(e) => setSource(e.target.value)}\n        disabled={isUploading}\n      />\n      <select\n        value={category}\n        onChange={(e) => setCategory(e.target.value)}\n        disabled={isUploading}\n      >\n        <option value=\"\">Choose category:</option>\n        {CATEGORIES.map((cat) => (\n          <option key={cat.name} value={cat.name}>\n            {cat.name}\n          </option>\n        ))}\n        ;\n      </select>\n      <button className=\"btn btn-large\" disabled={isUploading}>\n        Post\n      </button>\n    </form>\n  );\n}\n\nexport default NewFactForm;\n"],"mappings":"4gBAAA,OAASA,QAAQ,KAAQ,OAAO,CAChC,MAAO,CAAAC,QAAQ,KAAM,YAAY,CAAC,OAAAC,GAAA,IAAAC,IAAA,gCAAAC,IAAA,IAAAC,KAAA,yBAClC,IAAAC,QAAA,CAAuBC,OAAO,CAAC,WAAW,CAAC,CAAnCC,UAAU,CAAAF,QAAA,CAAVE,UAAU,CAElB,QAAS,CAAAC,cAAcA,CAACC,MAAM,CAAE,CAC9B,GAAI,CAAAC,GAAG,CACP,GAAI,CACFA,GAAG,CAAG,GAAI,CAAAC,GAAG,CAACF,MAAM,CAAC,CACvB,CAAE,MAAOG,CAAC,CAAE,CACV,MAAO,MAAK,CACd,CACA,MAAO,CAAAF,GAAG,CAACG,QAAQ,GAAK,OAAO,EAAIH,GAAG,CAACG,QAAQ,GAAK,QAAQ,CAC9D,CAEA,QAAS,CAAAC,WAAWA,CAAAC,IAAA,CAAmC,IAAhC,CAAAC,KAAK,CAAAD,IAAA,CAALC,KAAK,CAAEC,QAAQ,CAAAF,IAAA,CAARE,QAAQ,CAAEC,WAAW,CAAAH,IAAA,CAAXG,WAAW,CACjD,IAAAC,SAAA,CAAwBpB,QAAQ,CAAC,EAAE,CAAC,CAAAqB,UAAA,CAAAC,cAAA,CAAAF,SAAA,IAA7BG,IAAI,CAAAF,UAAA,IAAEG,OAAO,CAAAH,UAAA,IACpB,IAAAI,UAAA,CAA4BzB,QAAQ,CAAC,EAAE,CAAC,CAAA0B,UAAA,CAAAJ,cAAA,CAAAG,UAAA,IAAjCE,MAAM,CAAAD,UAAA,IAAEE,SAAS,CAAAF,UAAA,IACxB,IAAAG,UAAA,CAAgC7B,QAAQ,CAAC,EAAE,CAAC,CAAA8B,UAAA,CAAAR,cAAA,CAAAO,UAAA,IAArCE,QAAQ,CAAAD,UAAA,IAAEE,WAAW,CAAAF,UAAA,IAC5B,IAAAG,UAAA,CAAsCjC,QAAQ,CAAC,KAAK,CAAC,CAAAkC,UAAA,CAAAZ,cAAA,CAAAW,UAAA,IAA9CE,WAAW,CAAAD,UAAA,IAAEE,cAAc,CAAAF,UAAA,IAClC,GAAM,CAAAG,UAAU,CAAGd,IAAI,CAACe,MAAM,CAAC,QAEhB,CAAAC,YAAYA,CAAAC,EAAA,SAAAC,aAAA,CAAAC,KAAA,MAAAC,SAAA,YAAAF,cAAA,EAAAA,aAAA,CAAAG,iBAAA,cAAAC,mBAAA,GAAAC,IAAA,CAA3B,SAAAC,QAA4BC,CAAC,MAAAC,qBAAA,CAAAC,OAAA,CAAAC,KAAA,QAAAN,mBAAA,GAAAO,IAAA,UAAAC,SAAAC,QAAA,iBAAAA,QAAA,CAAAC,IAAA,CAAAD,QAAA,CAAAE,IAAA,SAC3B;AACAR,CAAC,CAACS,cAAc,EAAE,CAClB;AACArB,cAAc,CAAC,IAAI,CAAC,CAAC,KACjBb,IAAI,EAAId,cAAc,CAACkB,MAAM,CAAC,EAAII,QAAQ,EAAIM,UAAU,EAAI,GAAG,GAAAiB,QAAA,CAAAE,IAAA,WAAAF,QAAA,CAAAE,IAAA,SAE1B,CAAAvD,QAAQ,CAC5CyD,IAAI,CAAC,OAAO,CAAC,CACbC,MAAM,CAAC,CAAC,CAAEpC,IAAI,CAAJA,IAAI,CAAEI,MAAM,CAANA,MAAM,CAAEI,QAAQ,CAARA,QAAS,CAAC,CAAC,CAAC,CACpC6B,MAAM,EAAE,QAAAX,qBAAA,CAAAK,QAAA,CAAAO,IAAA,CAHGX,OAAO,CAAAD,qBAAA,CAAba,IAAI,CAAWX,KAAK,CAAAF,qBAAA,CAALE,KAAK,CAK5B;AACAf,cAAc,CAAC,KAAK,CAAC,CACrB,GAAI,CAACe,KAAK,CAAEjC,QAAQ,CAAC,SAACD,KAAK,SAAMiC,OAAO,CAAC,CAAC,CAAC,EAAAa,MAAA,CAAAC,kBAAA,CAAK/C,KAAK,IAAC,CAAC,CAEvD;AACAO,OAAO,CAAC,EAAE,CAAC,CACXI,SAAS,CAAC,EAAE,CAAC,CACbI,WAAW,CAAC,EAAE,CAAC,CAEf;AACAb,WAAW,CAAC,KAAK,CAAC,CAAC,QAErBiB,cAAc,CAAC,KAAK,CAAC,CAAC,yBAAAkB,QAAA,CAAAW,IAAA,MAAAlB,OAAA,GACvB,UAAAN,aAAA,CAAAC,KAAA,MAAAC,SAAA,GAED,mBACEtC,KAAA,SAAM6D,SAAS,CAAC,WAAW,CAACC,QAAQ,CAAE5B,YAAa,CAAA6B,QAAA,eACjDjE,IAAA,UACEkE,IAAI,CAAC,MAAM,CACXC,WAAW,CAAC,gCAAgC,CAC5CC,KAAK,CAAEhD,IAAK,CACZiD,QAAQ,CAAE,SAAAA,SAACxB,CAAC,QAAK,CAAAxB,OAAO,CAACwB,CAAC,CAACyB,MAAM,CAACF,KAAK,CAAC,EAAC,CACzCG,QAAQ,CAAEvC,WAAY,EACtB,cACFhC,IAAA,SAAAiE,QAAA,CAAO,GAAG,CAAG/B,UAAU,EAAQ,cAC/BlC,IAAA,UACEkE,IAAI,CAAC,MAAM,CACXC,WAAW,CAAC,uBAAuB,CACnCC,KAAK,CAAE5C,MAAO,CACd6C,QAAQ,CAAE,SAAAA,SAACxB,CAAC,QAAK,CAAApB,SAAS,CAACoB,CAAC,CAACyB,MAAM,CAACF,KAAK,CAAC,EAAC,CAC3CG,QAAQ,CAAEvC,WAAY,EACtB,cACF9B,KAAA,WACEkE,KAAK,CAAExC,QAAS,CAChByC,QAAQ,CAAE,SAAAA,SAACxB,CAAC,QAAK,CAAAhB,WAAW,CAACgB,CAAC,CAACyB,MAAM,CAACF,KAAK,CAAC,EAAC,CAC7CG,QAAQ,CAAEvC,WAAY,CAAAiC,QAAA,eAEtBjE,IAAA,WAAQoE,KAAK,CAAC,EAAE,CAAAH,QAAA,CAAC,kBAAgB,EAAS,CACzC5D,UAAU,CAACmE,GAAG,CAAC,SAACC,GAAG,qBAClBzE,IAAA,WAAuBoE,KAAK,CAAEK,GAAG,CAACC,IAAK,CAAAT,QAAA,CACpCQ,GAAG,CAACC,IAAI,EADED,GAAG,CAACC,IAAI,CAEZ,EACV,CAAC,CAAC,GAEL,GAAS,cACT1E,IAAA,WAAQ+D,SAAS,CAAC,eAAe,CAACQ,QAAQ,CAAEvC,WAAY,CAAAiC,QAAA,CAAC,MAEzD,EAAS,GACJ,CAEX,CAEA,cAAe,CAAArD,WAAW"},"metadata":{},"sourceType":"module","externalDependencies":[]}